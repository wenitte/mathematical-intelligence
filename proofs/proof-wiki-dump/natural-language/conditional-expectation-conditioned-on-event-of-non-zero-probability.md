# 

Source: https://proofwiki.org/wiki/Conditional_Expectation_Conditioned_on_Event_of_Non-Zero_Probability

Theorem
Let $\struct {\Omega, \Sigma, \Pr}$ be a probability space.
Let $X$ be an integrable random variable on $\struct {\Omega, \Sigma, \Pr}$.
Let $B \in \Sigma$ be an event with:

$\map \Pr B > 0$
Let:

$\GG = \map \sigma B = \set {\O, B, B^c, \Omega}$
where $\map \sigma B$ is the $\sigma$-algebra generated by $B$.
Let: 

$\ds \alpha = \frac {\expect {X \cdot 1_B} } {\map \Pr B}$
and:

$\ds \beta = \frac {\expect {X \cdot 1_{B^c} } } {\map \Pr {B^c} }$
Let $\expect {X \mid \GG}$ be a version of the conditional expectation of $X$ given $\GG$.

Then:

$\ds \expect {X \mid \GG} = \alpha \cdot 1_B + \beta \cdot 1_{B^c}$ almost everywhere.


Proof
We show that:

$\ds Z = \alpha \cdot 1_B + \beta \cdot 1_{B^c}$ is a version of the conditional expectation of $X$ given $\GG$.
We will then be done by Existence and Essential Uniqueness of Conditional Expectation Conditioned on Sigma-Algebra.
From Characteristic Function Measurable iff Set Measurable, $1_B$ and $1_{B^c}$ are both measurable functions.
From Pointwise Product of Measurable Functions is Measurable and Pointwise Sum of Measurable Functions is Measurable, we therefore have that $Z$ is a random variable. 
So we now verify that the expectations take the correct values. 
From Integral of Integrable Function over Null Set, we have: 

$\expect {Z \cdot 1_\O} = 0 = \expect {X \cdot 1_\O}$
We also have: 














\(\ds \expect {Z \cdot 1_B}\)

\(=\)







\(\ds \expect {\alpha \cdot 1_B + \beta \cdot 1_B \cdot 1_{B^c} }\)




















\(\ds \)

\(=\)







\(\ds \expect {\alpha \cdot 1_B}\)





Characteristic Function of Intersection














\(\ds \)

\(=\)







\(\ds \alpha \map \Pr B\)





Expectation is Linear: General Case, Integral of Characteristic Function














\(\ds \)

\(=\)







\(\ds \expect {X \cdot 1_B}\)









and:














\(\ds \expect {Z \cdot 1_{B^c} }\)

\(=\)







\(\ds \expect {\alpha \cdot 1_B \cdot 1_{B^c} + \beta \cdot 1_{B^c} }\)




















\(\ds \)

\(=\)







\(\ds \expect {\beta \cdot 1_{B^c} }\)





Characteristic Function of Intersection














\(\ds \)

\(=\)







\(\ds \beta \map \Pr {B^c}\)





Expectation is Linear: General Case, Integral of Characteristic Function














\(\ds \)

\(=\)







\(\ds \expect {X \cdot 1_{B^c} }\)









Finally, we have: 














\(\ds \expect Z\)

\(=\)







\(\ds \expect {\alpha \cdot 1_B + \beta \cdot 1_{B^c} }\)




















\(\ds \)

\(=\)







\(\ds \alpha \map \Pr B + \beta \map \Pr {B^c}\)





Expectation is Linear: General Case, Integral of Characteristic Function














\(\ds \)

\(=\)







\(\ds \expect {X \cdot 1_B} + \expect {X \cdot 1_{B^c} }\)




















\(\ds \)

\(=\)







\(\ds \expect {X \cdot \paren {1_B + 1_{B^c} } }\)





Expectation is Linear: General Case














\(\ds \)

\(=\)







\(\ds \expect X\)





Characteristic Function of Disjoint Union



$\blacksquare$





